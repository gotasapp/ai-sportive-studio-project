# 🔄 Legacy Mint Backup - Código Atual

**Data do Backup:** $(date)  
**Motivo:** Backup antes de alterações no mint legacy

## 📁 Arquivos Salvos:

### 1. `src/lib/useWeb3-legacy-backup.ts`
- Backup completo do useWeb3.ts atual
- Implementação Thirdweb v5 com mintTo()
- Upload IPFS via IPFSService
- sendTransaction() com usuário pagando gas

### 2. Função `handleMintNFT` do JerseyEditor.tsx

```typescript
// 🎯 LEGACY MINT - Direct SDK (fallback) - O FLUXO PRINCIPAL DO USUÁRIO
const handleMintNFT = async () => {
  if (!generatedImageBlob || !selectedTeam || !playerName || !playerNumber) {
    setMintError('Missing required data for minting')
    return
  }

  setIsMinting(true)
  setMintError(null)
  setMintSuccess(null)
  setMintStatus('pending');

  try {
    const nftName = `${selectedTeam} ${playerName} #${playerNumber}`
    const nftDescription = `AI-generated ${selectedTeam} jersey for ${playerName} #${playerNumber}. Style: ${selectedStyle}. Generated by AI Sports NFT Generator.`
    
    const attributes = [
      { trait_type: 'Team', value: selectedTeam },
      { trait_type: 'Player Name', value: playerName },
      { trait_type: 'Player Number', value: playerNumber },
      { trait_type: 'Style', value: selectedStyle },
      { trait_type: 'Quality', value: quality },
      { trait_type: 'Generator', value: 'AI Sports NFT' }
    ]

    console.log('🎯 LEGACY: Starting NFT mint process...')
    console.log('📦 Name:', nftName)
    console.log('📝 Description:', nftDescription)
    console.log('🎨 Attributes:', attributes)

    // Convert blob to File for the mint function
    const imageFile = new File([generatedImageBlob], `${nftName}.png`, { type: 'image/png' });
    
    const result = await mintNFTWithMetadata(
      nftName,
      nftDescription,
      imageFile,
      attributes,
      editionSize
    )

    console.log('✅ Legacy mint successful:', result)
    setMintStatus('success');
    setMintSuccess(`🎉 Legacy mint successful! Transaction: ${result.transactionHash}`)
    setTransactionHash(result.transactionHash || 'N/A')
    
  } catch (error: any) {
    console.error('❌ Legacy mint failed:', error)
    setMintStatus('error');
    
    if (error?.message?.includes('Please deploy a new NFT Collection contract')) {
      setMintError('❌ Current contract only supports batch URI. Please deploy a new NFT Collection contract with individual tokenURI support.')
    } else {
      setMintError(error instanceof Error ? error.message : 'Minting failed')
    }
    
  } finally {
    setIsMinting(false)
  }
}
```

## 🔧 Características da Implementação Atual:

### useWeb3.ts (Legacy):
- ✅ **Thirdweb v5 SDK**
- ✅ **createThirdwebClient + getContract**
- ✅ **mintTo() extension**
- ✅ **sendTransaction() - usuário paga gas**
- ✅ **Upload IPFS via IPFSService**
- ✅ **Amoy testnet (80002)**
- ✅ **Retorna: transactionHash, metadataUrl, imageUrl**

### handleMintNFT (JerseyEditor):
- ✅ **Validação completa de dados**
- ✅ **Conversão Blob → File**
- ✅ **Logs detalhados**
- ✅ **Status management (pending/success/error)**
- ✅ **Error handling específico**
- ✅ **Transaction hash display**

## 🔄 Para Restaurar:

Se precisar voltar ao código atual:

1. **Restaurar useWeb3.ts:**
```bash
cp src/lib/useWeb3-legacy-backup.ts src/lib/useWeb3.ts
```

2. **Restaurar handleMintNFT:**
   - Copiar a função acima de volta para JerseyEditor.tsx

## 📊 Status do Sistema (Antes das Alterações):

- **🚀 Mint Gasless**: ✅ Funcionando (Engine V3)
- **🎯 Mint Legacy**: ⚠️ Implementado mas não testado
- **🔗 Wallet Connection**: ✅ Thirdweb v5 apenas
- **📱 Frontend**: ✅ Dois botões separados
- **🌐 IPFS**: ✅ IPFSService configurado

---

**⚠️ IMPORTANTE:** Este backup garante que sempre poderemos voltar ao estado atual se algo der errado nas próximas alterações. 